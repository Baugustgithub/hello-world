<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Procurement Method Guide</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Theme Colors */
    :root {
      --primary: #F8B300; /* Gold */
      --primary-hover: #D69A00;
      --secondary: #111111; /* Black */
      --secondary-hover: #333333;
      --accent: #5A5A5A; /* Gray */
      --accent-hover: #888888;
      --muted: #f3f4f6;
      --muted-foreground: #6B7280;
      --border: #E5E7EB;
      --foreground: #374151;
      --background: #FFFFFF;
      --card: #FFFFFF;
      --card-foreground: #374151;
      --radius: 0.5rem;
      --ring: #E5E7EB;
      --blue: #004B87; /* Blue for accents */
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      color: var(--foreground);
      background-color: #F9FAFB;
      line-height: 1.5;
    }

    /* Container styles */
    .container {
      width: 100%;
      max-width: 1024px;
      margin: 0 auto;
      padding: 1.5rem 1rem;
    }

    /* Typography */
    h1 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      color: var(--primary);
    }

    h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    h3 {
      font-size: 1.125rem;
      font-weight: 500;
      margin-bottom: 0.75rem;
    }

    h4 {
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    p {
      margin-bottom: 1rem;
    }

    /* Card styles */
    .card {
      background-color: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 1.5rem;
    }

    .card-header {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--card-foreground);
    }

    .card-description {
      font-size: 0.875rem;
      color: var(--muted-foreground);
      margin-top: 0.25rem;
    }

    .card-content {
      padding: 1.5rem;
    }

    .card-footer {
      padding: 1.25rem 1.5rem;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
    }

    /* Button styles */
    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius);
      font-size: 0.875rem;
      font-weight: 500;
      padding: 0.5rem 1rem;
      transition: all 0.2s ease-in-out;
      cursor: pointer;
      border: 1px solid transparent;
    }

    .button-primary {
      background-color: var(--primary);
      color: #FFFFFF;
    }

    .button-primary:hover {
      background-color: var(--primary-hover);
    }

    .button-secondary {
      background-color: var(--secondary);
      color: #FFFFFF;
    }

    .button-secondary:hover {
      background-color: var(--secondary-hover);
    }

    .button-outline {
      background-color: transparent;
      border-color: var(--border);
      color: var(--foreground);
    }

    .button-outline:hover {
      border-color: var(--accent);
      background-color: var(--muted);
    }

    /* Form styles */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    .form-helper {
      font-size: 0.75rem;
      color: var(--muted-foreground);
      margin-top: 0.25rem;
    }

    .form-control {
      width: 100%;
      padding: 0.5rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background-color: var(--background);
      font-size: 0.875rem;
      color: var(--foreground);
      transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    .form-control:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(0, 75, 135, 0.2);
      border-color: var(--primary);
    }

    /* Radio and select styles */
    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .radio-item {
      display: flex;
      align-items: center;
      position: relative;
      padding-left: 1.75rem;
      cursor: pointer;
    }

    .radio-item input {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      height: 0;
      width: 0;
    }

    .radio-checkmark {
      position: absolute;
      top: 0.25rem;
      left: 0;
      height: 1rem;
      width: 1rem;
      background-color: white;
      border-radius: 50%;
      border: 1px solid var(--border);
    }

    .radio-item:hover input ~ .radio-checkmark {
      background-color: var(--muted);
    }

    .radio-item input:checked ~ .radio-checkmark {
      background-color: var(--primary);
      border-color: var(--primary);
    }

    .radio-checkmark:after {
      content: "";
      position: absolute;
      display: none;
    }

    .radio-item input:checked ~ .radio-checkmark:after {
      display: block;
    }

    .radio-item .radio-checkmark:after {
      top: 0.25rem;
      left: 0.25rem;
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 50%;
      background: white;
    }

    /* Result area */
    .result-section {
      background-color: #f8f9fa;
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      line-height: 1;
      padding: 0.25rem 0.75rem;
      background-color: #EFF6FF;
      color: #1E40AF;
      border: 1px solid #DBEAFE;
    }

    /* Icons */
    .icon {
      width: 1rem;
      height: 1rem;
      display: inline-block;
      vertical-align: middle;
    }

    .icon-arrow-right {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>');
      background-size: contain;
      background-repeat: no-repeat;
    }

    .icon-alert-circle {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>');
      background-size: contain;
      background-repeat: no-repeat;
    }

    .icon-check-circle {
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>');
      background-size: contain;
      background-repeat: no-repeat;
    }

    /* Separator */
    .separator {
      height: 1px;
      background-color: var(--border);
      margin: 1.5rem 0;
    }

    /* Alert */
    .alert {
      display: flex;
      padding: 1rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 1rem;
      align-items: flex-start;
      gap: 0.75rem;
      background-color: #F9FAFB;
    }

    .alert-icon {
      flex-shrink: 0;
      width: 1rem;
      height: 1rem;
      margin-top: 0.125rem;
    }

    .alert-title {
      font-weight: 500;
      font-size: 0.875rem;
      margin-bottom: 0.25rem;
    }

    .alert-description {
      font-size: 0.75rem;
      color: var(--muted-foreground);
    }

    /* Progress indicator */
    .step-indicator {
      display: flex;
      margin-bottom: 2rem;
    }

    .step {
      flex: 1;
      text-align: center;
      padding: 0.5rem;
      position: relative;
    }

    .step:not(:last-child)::after {
      content: '';
      position: absolute;
      top: 1rem;
      right: 0;
      width: calc(100% - 2rem);
      height: 2px;
      background-color: var(--border);
      z-index: 0;
    }

    .step-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      background-color: var(--muted);
      border: 2px solid var(--border);
      color: var(--muted-foreground);
      font-weight: 500;
      position: relative;
      z-index: 1;
      margin-bottom: 0.5rem;
    }

    .step.active .step-number {
      background-color: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    .step-title {
      font-size: 0.75rem;
      font-weight: 500;
    }

    /* Utility classes */
    .mb-4 {
      margin-bottom: 1rem;
    }

    .mt-2 {
      margin-top: 0.5rem;
    }

    .mb-3 {
      margin-bottom: 0.75rem;
    }

    .mr-2 {
      margin-right: 0.5rem;
    }

    .space-y-1 > * + * {
      margin-top: 0.25rem;
    }

    .flex {
      display: flex;
    }

    .items-center {
      align-items: center;
    }

    .text-sm {
      font-size: 0.875rem;
    }

    .text-lg {
      font-size: 1.125rem;
    }

    .font-medium {
      font-weight: 500;
    }

    .grid {
      display: grid;
    }

    .grid-cols-1 {
      grid-template-columns: repeat(1, minmax(0, 1fr));
    }

    .gap-4 {
      gap: 1rem;
    }

    @media (min-width: 1024px) {
      .lg\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Procurement Method Selection Guide</h1>

    <div class="step-indicator">
      <div class="step active" id="stepIndicator1">
        <div class="step-number">1</div>
        <div class="step-title">Start</div>
      </div>
      <div class="step" id="stepIndicator2">
        <div class="step-number">2</div>
        <div class="step-title">Existing Contract</div>
      </div>
      <div class="step" id="stepIndicator3">
        <div class="step-number">3</div>
        <div class="step-title">Criteria</div>
      </div>
      <div class="step" id="stepIndicator4">
        <div class="step-number">4</div>
        <div class="step-title">Result</div>
      </div>
    </div>

    <!-- Step 1: Introduction -->
    <div id="step1" class="card">
      <div class="card-header">
        <div class="card-title">Determine the Right Procurement Method</div>
        <div class="card-description">
          This guide will help you identify the appropriate procurement method based on your specific needs.
        </div>
      </div>
      <div class="card-content">
        <p>
          Finding the right procurement method is crucial for ensuring compliance with regulations and obtaining the best value. This tool will guide you through the selection process based on your purchase details.
        </p>

        <div class="alert">
          <span class="alert-icon icon-alert-circle"></span>
          <div>
            <div class="alert-title">Important Note</div>
            <div class="alert-description">
              This tool provides general guidance based on common procurement practices. Always consult with your procurement office for official guidance.
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <button class="button button-primary" onclick="showStep('step2')">Get Started <span class="icon icon-arrow-right" style="margin-left: 0.25rem;"></span></button>
      </div>
    </div>

    <!-- Step 2: Existing Contract Check -->
    <div id="step2" class="card" style="display: none;">
      <div class="card-header">
        <div class="card-title">Check for Existing Contracts</div>
        <div class="card-description">
          First, determine if there's an existing contract that meets your needs.
        </div>
      </div>
      <div class="card-content">
        <p>Before starting a new procurement process, check if there are existing contracts available that meet your requirements.</p>

        <div class="alert">
          <span class="alert-icon icon-alert-circle"></span>
          <div>
            <div class="alert-title">Have you checked for existing contracts?</div>
            <div class="alert-description">
              Using an existing contract is often faster and more efficient than starting a new procurement process.
            </div>
          </div>
        </div>
        
        <div class="mb-4">
          <h4 class="font-medium mb-2">Where to Check for Existing Contracts</h4>
          <ul class="text-sm mb-4">
            <li><a href="https://vascupp.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VASCUPP - Virginia Association of State College and University Purchasing Professionals</a></li>
            <li><a href="https://vhepc.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VHEPC - Virginia Higher Education Procurement Consortium</a></li>
            <li><a href="https://eva.virginia.gov/pages/eva-eprocurement-system.htm" target="_blank" style="color: var(--blue); text-decoration: underline;">eVA - Virginia's eProcurement Portal</a></li>
            <li><a href="https://www.withpavilion.com" target="_blank" style="color: var(--blue); text-decoration: underline;">Pavilion</a></li>
            
          </ul>
        </div>

        <h3 class="mb-3">Do you have an existing contract available?</h3>
        <div class="radio-group mb-4">
          <label class="radio-item">
            <input type="radio" name="existing_contract" value="yes" onchange="existingContractSelected(true)" />
            <span class="radio-checkmark"></span>
            Yes, I've found an existing contract that meets my needs
          </label>
          <label class="radio-item">
            <input type="radio" name="existing_contract" value="no" onchange="existingContractSelected(false)" checked />
            <span class="radio-checkmark"></span>
            No, I need to initiate a new procurement
          </label>
        </div>
      </div>
      <div class="card-footer">
        <button class="button button-outline" onclick="showStep('step1')">Back</button>
        <button class="button button-primary" onclick="showStep('step3')">Continue</button>
      </div>
    </div>

    <!-- Step 3: Procurement Details -->
    <div id="step3" class="card" style="display: none;">
      <div class="card-header">
        <div class="card-title">Enter Procurement Details</div>
        <div class="card-description">
          Provide information about your purchase to determine the appropriate method.
        </div>
      </div>
      <div class="card-content">
        <form id="procurementForm">
          <div class="form-group">
            <label class="form-label">Estimated Dollar Value</label>
            <input id="estimatedValue" class="form-control" type="text" placeholder="e.g. 50000" />
            <div class="form-helper">Enter the estimated dollar value of the purchase (numbers only).</div>
          </div>

          <div class="form-group">
            <label class="form-label">Purchase Type</label>
            <select id="purchaseType" class="form-control">
              <optgroup label="Standard Categories">
                <option value="goods">Standard Goods</option>
                <option value="services">Standard Services</option>
                <option value="consulting">Consulting Services</option>
                <option value="solutions">Technical Solutions</option>
                <option value="construction">Construction/Facilities</option>
                <option value="recurring_needs">Recurring Needs</option>
              </optgroup>
              <optgroup label="Emergency Categories">
                <option value="emergency">Life/Safety Emergency</option>
                <option value="critical_need">Critical Operational Need</option>
                <option value="disaster_response">Natural Disaster Response</option>
              </optgroup>
              <optgroup label="Sole Source Categories">
                <option value="proprietary">Proprietary/Sole Vendor</option>
                <option value="unique_source">Unique Source</option>
                <option value="compatible_with_existing">Compatible with Existing</option>
              </optgroup>
              <optgroup label="Exceptions to Competition">
                <option value="arts_media_speakers">Performing Artists/Speakers (No $ Limit)</option>
                <option value="arts_media_limited">Media/Game Officials (Up to $200K)</option>
                <option value="educational_institutions">Educational Institutions (No $ Limit)</option>
                <option value="education_research_limited">Education/Research Services (Up to $200K)</option>
                <option value="conference_facilities">Conference Facilities (No $ Limit)</option>
                <option value="foreign_group_travel">Foreign Travel Arrangements (No $ Limit)</option>
                <option value="athletic_events">Athletic Events (No $ Limit)</option>
                <option value="international_purchases">International Purchases (Up to $200K)</option>
                <option value="legal_services">Legal Services (No $ Limit)</option>
                <option value="health_services_limited">Health/Medical Services (Up to $200K)</option>
                <option value="utilities">Utilities & Infrastructure (No $ Limit)</option>
                <option value="memberships_subscriptions">Memberships/Subscriptions (No $ Limit)</option>
                <option value="public_auctions">Public Auctions/Surplus (No $ Limit)</option>
                <option value="gov_sponsored_research">Gov't Sponsored Research (No $ Limit)</option>
                <option value="used_equipment">Used Equipment (Up to $200K)</option>
                <option value="awards_gifts">Awards, Gifts, Souvenirs (Up to $200K)</option>
                <option value="charitable_organizations">Charitable Organizations (No $ Limit)</option>
                <option value="student_field_trips">Student Field Trips (No $ Limit)</option>
                <option value="academic_peer_review">Academic Peer Review (No $ Limit)</option>
                <option value="maintenance_repair">Equipment Maintenance & Repair (Up to $200K)</option>
                <option value="exclusive_software">Specialized Software & Databases (Up to $200K)</option>
                <option value="real_estate_leases">Real Estate Leases (Up to $200K)</option>
                <option value="govt_sources">Government Sources (No $ Limit)</option>
                <option value="special_workshops">Sheltered Workshops & Blind Services (No $ Limit)</option>
                <option value="grant_subawards">Grant Sub-awards (No $ Limit)</option>
                <option value="royalties">Royalties (No $ Limit)</option>
                <option value="pass_through">Pass-Through Procurements (Up to $200K)</option>
                <option value="sponsorships">Sponsorships (Up to $200K)</option>
                <option value="honoraria">Honoraria (Up to $200K)</option>
                <option value="facilitators_mediators">Facilitators & Mediators (Up to $200K)</option>
              </optgroup>
              <optgroup label="Other">
                <option value="existing_contract">Using Existing Contract</option>
              </optgroup>
            </select>
            <div class="form-helper">Select the category that best describes what you're purchasing.</div>
          </div>

          <div class="form-group">
            <label class="form-label">Complexity Level</label>
            <div class="radio-group">
              <label class="radio-item">
                <input type="radio" name="complexity" value="low" />
                <span class="radio-checkmark"></span>
                Low - Standard/common items with clear specifications
              </label>
              <label class="radio-item">
                <input type="radio" name="complexity" value="medium" checked />
                <span class="radio-checkmark"></span>
                Medium - Moderate customization or technical requirements
              </label>
              <label class="radio-item">
                <input type="radio" name="complexity" value="high" />
                <span class="radio-checkmark"></span>
                High - Complex solutions requiring significant expertise
              </label>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Timeline</label>
            <div class="radio-group">
              <label class="radio-item">
                <input type="radio" name="timeline" value="urgent" />
                <span class="radio-checkmark"></span>
                Urgent - Need within 2-4 weeks
              </label>
              <label class="radio-item">
                <input type="radio" name="timeline" value="standard" checked />
                <span class="radio-checkmark"></span>
                Standard - Need within 1-3 months
              </label>
              <label class="radio-item">
                <input type="radio" name="timeline" value="flexible" />
                <span class="radio-checkmark"></span>
                Flexible - Timeline can be adjusted as needed
              </label>
            </div>
          </div>
        </form>
      </div>
      <div class="card-footer">
        <button class="button button-outline" onclick="showStep('step2')">Back</button>
        <button class="button button-primary" onclick="getRecommendation()">Get Recommendation</button>
      </div>
    </div>

    <!-- Step 4: Recommendation Result -->
    <div id="step4" class="card" style="display: none;">
      <div class="card-header">
        <div class="card-title">Recommended Procurement Method</div>
        <div class="card-description">
          Based on your inputs, we recommend the following approach.
        </div>
      </div>
      <div class="card-content">
        <div id="resultCard" class="result-section">
          <h3 id="resultTitle" class="text-lg font-medium mb-3">Loading recommendation...</h3>

          <div class="mb-4">
            <div class="space-y-1">
              <div class="flex items-center">
                <span class="text-sm font-medium mr-2">Estimated Value:</span>
                <span id="resultValue" class="text-sm"></span>
              </div>
              <div class="flex items-center">
                <span class="text-sm font-medium mr-2">Purchase Type:</span>
                <span id="resultType" class="text-sm"></span>
              </div>
              <div class="flex items-center">
                <span class="text-sm font-medium mr-2">Complexity:</span>
                <span id="resultComplexity" class="text-sm"></span>
              </div>
              <div class="flex items-center">
                <span class="text-sm font-medium mr-2">Timeline:</span>
                <span id="resultTimeline" class="text-sm"></span>
              </div>
            </div>
          </div>

          <div class="separator"></div>

          <div class="mb-4">
            <h4 class="font-medium mb-2">Method Description</h4>
            <p id="resultDescription" class="text-sm"></p>
          </div>

          <div class="mb-4">
            <h4 class="font-medium mb-2">Suitable For</h4>
            <p id="resultSuitableFor" class="text-sm"></p>
          </div>

          <div class="mb-4">
            <h4 class="font-medium mb-2">Typical Timeframe</h4>
            <p id="resultTimeframe" class="text-sm"></p>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
            <div>
              <h4 class="font-medium mb-2">Advantages</h4>
              <ul id="resultAdvantages" class="text-sm"></ul>
            </div>

            <div>
              <h4 class="font-medium mb-2">Disadvantages</h4>
              <ul id="resultDisadvantages" class="text-sm"></ul>
            </div>
          </div>

          <div class="alert">
            <span class="alert-icon icon-alert-circle"></span>
            <div class="alert-title">Next Steps</div>
            <div class="alert-description">
              Contact your procurement services department to initiate this process. Be sure to have your specifications and requirements documented.
            </div>
          </div>

          <div class="separator"></div>
          
          <div class="mb-4">
            <h4 class="font-medium mb-2">Helpful Resources</h4>
            <ul class="text-sm">
              <li><a href="https://vascupp.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VASCUPP - Virginia Association of State College and University Purchasing Professionals</a></li>
              <li><a href="https://vhepc.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VHEPC - Virginia Higher Education Procurement Consortium</a></li>
              <li><a href="https://eva.virginia.gov/pages/eva-eprocurement-system.htm" target="_blank" style="color: var(--blue); text-decoration: underline;">eVA - Virginia's eProcurement Portal</a></li>
              <li><a href="https://www.withpavilion.com" target="_blank" style="color: var(--blue); text-decoration: underline;">Pavilion</a></li>
              
            </ul>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <button class="button button-outline" onclick="showStep('step3')">Go Back</button>
        <button class="button button-primary" onclick="window.print()">
          Print This Recommendation
        </button>
      </div>
    </div>

    <!-- Contract Found Success Message -->
    <div id="contractFound" class="card" style="display: none;">
      <div class="card-header">
        <div class="card-title">Existing Contract Found</div>
        <div class="card-description">
          Great! Using an existing contract is usually the fastest and most efficient approach.
        </div>
      </div>
      <div class="card-content">
        <div class="alert" style="background-color: #ECFDF5; border-color: #D1FAE5;">
          <span class="alert-icon icon-check-circle"></span>
          <div class="alert-title">Use the Existing Contract</div>
          <div class="alert-description">
            Since you've found an existing contract that meets your needs, you can proceed with using that contract without needing a new solicitation process.
          </div>
        </div>

        <div class="mt-2 mb-4">
          <h3 class="text-lg font-medium mb-3">Next Steps:</h3>
          <ol class="space-y-1">
            <li>Verify the contract terms and conditions meet your specific requirements</li>
            <li>Contact the contract administrator for pricing and ordering information</li>
            <li>Follow your organization's procedures for using existing contracts</li>
            <li>Document your use of the existing contract in your procurement file</li>
          </ol>
        </div>

        <button class="button button-primary" onclick="window.print()">
          Print This Information
        </button>

        <div class="separator"></div>
          
        <div class="mb-4">
          <h4 class="font-medium mb-2">Helpful Resources</h4>
          <ul class="text-sm">
            <li><a href="https://vascupp.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VASCUPP - Virginia Association of State College and University Purchasing Professionals</a></li>
            <li><a href="https://vhepc.org" target="_blank" style="color: var(--blue); text-decoration: underline;">VHEPC - Virginia Higher Education Procurement Consortium</a></li>
            <li><a href="https://eva.virginia.gov/pages/eva-eprocurement-system.htm" target="_blank" style="color: var(--blue); text-decoration: underline;">eVA - Virginia's eProcurement Portal</a></li>
            <li><a href="https://www.withpavilion.com" target="_blank" style="color: var(--blue); text-decoration: underline;">Pavilion</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Simple navigation between steps
    function showStep(stepId) {
      // Hide all steps
      document.getElementById('step1').style.display = 'none';
      document.getElementById('step2').style.display = 'none';
      document.getElementById('step3').style.display = 'none';
      document.getElementById('step4').style.display = 'none';
      document.getElementById('contractFound').style.display = 'none';

      // Show the requested step
      document.getElementById(stepId).style.display = 'block';

      // Update step indicators
      document.getElementById('stepIndicator1').classList.remove('active');
      document.getElementById('stepIndicator2').classList.remove('active');
      document.getElementById('stepIndicator3').classList.remove('active');
      document.getElementById('stepIndicator4').classList.remove('active');

      if (stepId === 'step1') {
        document.getElementById('stepIndicator1').classList.add('active');
      } else if (stepId === 'step2') {
        document.getElementById('stepIndicator2').classList.add('active');
      } else if (stepId === 'step3') {
        document.getElementById('stepIndicator3').classList.add('active');
      } else if (stepId === 'step4' || stepId === 'contractFound') {
        document.getElementById('stepIndicator4').classList.add('active');
      }
    }

    function showContractFound() {
      showStep('contractFound');
    }

    function existingContractSelected(yesSelected) {
      if (yesSelected) {
        // If user selects "Yes" for existing contract, update the purchase type dropdown
        document.getElementById('purchaseType').value = 'existing_contract';
      } else {
        // If user selects "No", reset the dropdown to the first option
        document.getElementById('purchaseType').value = 'goods';
      }
    }

    // Format currency
    function formatCurrency(value) {
      return new Intl.NumberFormat('en-US', { 
        style: 'currency', 
        currency: 'USD',
        maximumFractionDigits: 0
      }).format(parseFloat(value) || 0);
    }

    // Get procurement recommendation based on form inputs
    function getRecommendation() {
      // Get form values
      const estimatedValue = document.getElementById('estimatedValue').value;
      const purchaseType = document.getElementById('purchaseType').value;
      const complexity = document.querySelector('input[name="complexity"]:checked').value;
      const timeline = document.querySelector('input[name="timeline"]:checked').value;

      // Validate inputs
      if (!estimatedValue) {
        alert('Please enter an estimated value.');
        return;
      }

      // Special handling for existing contract
      if (purchaseType === 'existing_contract') {
        showContractFound();
        return;
      }

      // Set form result data
      document.getElementById('resultValue').textContent = formatCurrency(estimatedValue);
      document.getElementById('resultType').textContent = getPurchaseTypeLabel(purchaseType);
      document.getElementById('resultComplexity').textContent = capitalizeFirstLetter(complexity);
      document.getElementById('resultTimeline').textContent = capitalizeFirstLetter(timeline);

      // Determine recommendation based on inputs
      let recommendedMethod;
      const valueNum = parseFloat(estimatedValue);

      if (valueNum <= 10000) {
        recommendedMethod = {
          name: "Delegated Authority",
          description: "Departments can directly procure goods and services under $10,000 using a credit card or electronic procurement system.",
          suitableFor: "Low-dollar routine purchases that don't require extensive competition.",
          typicalTimeframe: "Immediate to several days",
          advantages: [
            "Quick and efficient process",
            "Minimal paperwork required",
            "Department controls the purchasing timeline"
          ],
          disadvantages: [
            "Limited to purchases under $10,000",
            "Still requires documentation of fair and reasonable pricing",
            "Must follow all organizational policies and procedures"
          ]
        };
      } else if (valueNum <= 200000) {
        if (complexity === 'high' || timeline === 'flexible') {
          recommendedMethod = {
            name: "Best Value Acquisition (BVA)",
            description: "A small purchase procedure that considers factors beyond price, such as quality, vendor experience, and delivery time.",
            suitableFor: "Purchases where quality, expertise, and other factors are as important as price.",
            typicalTimeframe: "15-60 days depending on complexity",
            advantages: [
              "Allows consideration of quality and expertise",
              "More flexible than quote-based methods",
              "Good for services and complex products"
            ],
            disadvantages: [
              "Typically takes longer than RFQ process",
              "Requires more documentation and evaluation",
              "More subjective decision-making process"
            ]
          };
        } else {
          recommendedMethod = {
            name: "Request for Quote (RFQ)",
            description: "A simplified process to obtain quotes from multiple vendors, with award typically made to the lowest priced vendor.",
            suitableFor: "Straightforward purchases where specifications are clear and price is the primary consideration.",
            typicalTimeframe: "5-30 days depending on complexity",
            advantages: [
              "Faster than BVA process",
              "Simple evaluation based primarily on price",
              "Less documentation required"
            ],
            disadvantages: [
              "Limited to price-based selections",
              "May not allow for adequate quality consideration",
              "Not ideal for complex services"
            ]
          };
        }
      } else {
        // Over $200,000
        if (complexity === 'high' || purchaseType === 'consulting' || purchaseType === 'solutions') {
          recommendedMethod = {
            name: "Request for Proposal (RFP)",
            description: "A formal solicitation process that evaluates price along with other factors such as expertise, quality, and approach.",
            suitableFor: "Complex purchases where factors other than price are important considerations.",
            typicalTimeframe: "60-120+ days",
            advantages: [
              "Allows for consideration of quality, expertise, and approach",
              "Flexible negotiation process",
              "Best for complex services or solutions"
            ],
            disadvantages: [
              "Lengthy timeline",
              "Significant documentation requirements",
              "Complex evaluation process"
            ]
          };
        } else {
          recommendedMethod = {
            name: "Invitation for Bid (IFB)",
            description: "A formal process where vendors bid on a specific set of requirements, with award made to the lowest responsive and responsible bidder.",
            suitableFor: "Purchases with clear, detailed specifications where price is the primary factor.",
            typicalTimeframe: "45-90+ days",
            advantages: [
              "Transparent price-based selection",
              "Typically faster than RFP process",
              "Clear, objective evaluation criteria"
            ],
            disadvantages: [
              "Limited to price-based selection",
              "Requires very detailed specifications",
              "Limited flexibility after bid opening"
            ]
          };
        }
      }

      // Handle special cases - emergency needs
      if (timeline === 'urgent' && complexity !== 'high') {
        if (purchaseType === 'emergency' || purchaseType === 'disaster_response' || purchaseType === 'critical_need') {
          recommendedMethod = {
            name: "Emergency Procurement",
            description: "An expedited process for urgent needs where following normal procedures would cause harm or significant operational impact.",
            suitableFor: "True emergencies where delay would cause harm or significant operational issues.",
            typicalTimeframe: "1-5 business days",
            advantages: [
              "Extremely fast process",
              "Minimal competition requirements",
              "Immediate response to urgent needs"
            ],
            disadvantages: [
              "Requires emergency justification",
              "Limited to genuine emergencies",
              "Requires post-procurement documentation"
            ]
          };
        }
      }

      // Special case for sole source
      if (purchaseType === 'proprietary' || purchaseType === 'unique_source' || purchaseType === 'compatible_with_existing') {
        recommendedMethod = {
          name: "Sole Source Procurement",
          description: "A process used when only one vendor can provide the required goods or services.",
          suitableFor: "Situations where only one source is practically available or where compatibility with existing systems is required.",
          typicalTimeframe: "5-15+ business days",
          advantages: [
            "No competitive solicitation required",
            "Can be faster than competitive methods",
            "Good for proprietary or unique products/services"
          ],
          disadvantages: [
            "Requires thorough sole source justification",
            "May result in higher prices due to lack of competition",
            "Subject to additional scrutiny"
          ]
        };
      }

      // Special case for recurring needs
      if (purchaseType === 'recurring_needs') {
        if (valueNum > 200000) {
          recommendedMethod = {
            name: "Term Contract",
            description: "A long-term agreement that establishes pricing and terms for recurring purchases over a specific period.",
            suitableFor: "Recurring needs where establishing a relationship with one or more vendors provides better pricing and service.",
            typicalTimeframe: "60-120+ days to establish",
            advantages: [
              "Simplified ordering process once established",
              "Volume discounts and better pricing",
              "Reduced administrative burden for repeat purchases"
            ],
            disadvantages: [
              "Significant upfront time to establish",
              "Requires forecasting future needs",
              "May limit flexibility for changing requirements"
            ]
          };
        } else {
          recommendedMethod = {
            name: "Small Purchase Term Contract",
            description: "A simplified term agreement for recurring purchases under $200,000.",
            suitableFor: "Predictable, recurring purchases where establishing preset terms is beneficial.",
            typicalTimeframe: "15-60 days to establish",
            advantages: [
              "Faster to establish than large term contracts",
              "Reduced administrative work for repeat purchases",
              "Consistent pricing and service levels"
            ],
            disadvantages: [
              "Limited to purchases under $200,000",
              "Typically shorter term than large contracts",
              "May need periodic re-competition"
            ]
          };
        }
      }

      // Exceptions to Competition categories
      const exceptionsToCompetition = [
        'arts_media_speakers', 'arts_media_limited', 'educational_institutions', 
        'education_research_limited', 'conference_facilities', 'foreign_group_travel', 
        'athletic_events', 'international_purchases', 'legal_services', 
        'health_services_limited', 'utilities', 'memberships_subscriptions', 
        'public_auctions', 'gov_sponsored_research', 'used_equipment', 
        'awards_gifts', 'charitable_organizations', 'student_field_trips', 
        'academic_peer_review', 'maintenance_repair', 'exclusive_software', 
        'real_estate_leases', 'govt_sources', 'special_workshops', 
        'grant_subawards', 'royalties', 'pass_through', 
        'sponsorships', 'honoraria', 'facilitators_mediators'
      ];

      if (exceptionsToCompetition.includes(purchaseType)) {
        const purchaseLabel = getPurchaseTypeLabel(purchaseType);
        const hasLimit = purchaseLabel.includes('Up to $200K');

        recommendedMethod = {
          name: "Exception to Competition",
          description: `This purchase falls under the "${purchaseLabel}" exception category, which is exempt from standard competition requirements.`,
          suitableFor: "Specific categories of purchases that are exempt from competition by policy.",
          typicalTimeframe: "5-15+ business days",
          advantages: [
            "No competitive solicitation required",
            "Streamlined purchasing process",
            "Formal exemption already established by policy"
          ],
          disadvantages: [
            "Must still document use of the exception",
            "Must strictly adhere to the exception criteria",
            hasLimit ? "Subject to dollar value limits" : "Should still ensure fair and reasonable pricing"
          ]
        };
      }

      // Update the recommendation display
      document.getElementById('resultTitle').textContent = recommendedMethod.name;
      document.getElementById('resultDescription').textContent = recommendedMethod.description;
      document.getElementById('resultSuitableFor').textContent = recommendedMethod.suitableFor;
      document.getElementById('resultTimeframe').textContent = recommendedMethod.typicalTimeframe;

      // Clear and populate lists
      const advantagesList = document.getElementById('resultAdvantages');
      const disadvantagesList = document.getElementById('resultDisadvantages');

      advantagesList.innerHTML = '';
      disadvantagesList.innerHTML = '';

      recommendedMethod.advantages.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        advantagesList.appendChild(li);
      });

      recommendedMethod.disadvantages.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        disadvantagesList.appendChild(li);
      });

      // Show the results
      showStep('step4');
    }

    function getPurchaseTypeLabel(purchaseType) {
      const labels = {
        // Standard Categories
        'goods': 'Standard Goods',
        'services': 'Standard Services',
        'consulting': 'Consulting Services',
        'solutions': 'Technical Solutions',
        'construction': 'Construction/Facilities',
        'recurring_needs': 'Recurring Needs',

        // Emergency Categories
        'emergency': 'Life/Safety Emergency',
        'critical_need': 'Critical Operational Need',
        'disaster_response': 'Natural Disaster Response',

        // Sole Source Categories
        'proprietary': 'Proprietary/Sole Vendor',
        'unique_source': 'Unique Source',
        'compatible_with_existing': 'Compatible with Existing',

        // Exceptions to Competition
        'arts_media_speakers': 'Performing Artists/Speakers (No $ Limit)',
        'arts_media_limited': 'Media/Game Officials (Up to $200K)',
        'educational_institutions': 'Educational Institutions (No $ Limit)',
        'education_research_limited': 'Education/Research Services (Up to $200K)',
        'conference_facilities': 'Conference Facilities (No $ Limit)',
        'foreign_group_travel': 'Foreign Travel Arrangements (No $ Limit)',
        'athletic_events': 'Athletic Events (No $ Limit)',
        'international_purchases': 'International Purchases (Up to $200K)',
        'legal_services': 'Legal Services (No $ Limit)',
        'health_services_limited': 'Health/Medical Services (Up to $200K)',
        'utilities': 'Utilities & Infrastructure (No $ Limit)',
        'memberships_subscriptions': 'Memberships/Subscriptions (No $ Limit)',
        'public_auctions': 'Public Auctions/Surplus (No $ Limit)',
        'gov_sponsored_research': 'Gov\'t Sponsored Research (No $ Limit)',
        'used_equipment': 'Used Equipment (Up to $200K)',
        'awards_gifts': 'Awards, Gifts, Souvenirs (Up to $200K)',
        'charitable_organizations': 'Charitable Organizations (No $ Limit)',
        'student_field_trips': 'Student Field Trips (No $ Limit)',
        'academic_peer_review': 'Academic Peer Review (No $ Limit)',
        'maintenance_repair': 'Equipment Maintenance & Repair (Up to $200K)',
        'exclusive_software': 'Specialized Software & Databases (Up to $200K)',
        'real_estate_leases': 'Real Estate Leases (Up to $200K)',
        'govt_sources': 'Government Sources (No $ Limit)',
        'special_workshops': 'Sheltered Workshops & Blind Services (No $ Limit)',
        'grant_subawards': 'Grant Sub-awards (No $ Limit)',
        'royalties': 'Royalties (No $ Limit)',
        'pass_through': 'Pass-Through Procurements (Up to $200K)',
        'sponsorships': 'Sponsorships (Up to $200K)',
        'honoraria': 'Honoraria (Up to $200K)',
        'facilitators_mediators': 'Facilitators & Mediators (Up to $200K)',

        // Other
        'existing_contract': 'Using Existing Contract'
      };

      return labels[purchaseType] || purchaseType;
    }

    function capitalizeFirstLetter(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }
  </script>
</body>
</html>